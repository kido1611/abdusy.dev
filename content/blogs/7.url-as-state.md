---
title: 'URL as State'
description: 'Menggunakan URL Query sebagai state'
author: 'Muhammad Abdusy Syukur'
created_at: '2024-02-11 14:58:00'
---

# URL as State

Penggunaan URL sebagai state sangatlah bagus, terutama dalam kondisi bilamana menginginkan state dalam kondisi yang **tidak berubah saat melakukan refresh halaman** ataupun saat **state yang bisa merubah halaman tujuan** saat berpindah halaman üòÅ. Salah satu contoh penggunaannya adalah **FILTER** di suatu halaman.

## Contoh

Hasil dapat dilihat di [url-state](/examples/url-state)

```vue
<template>
  <div>
    <h1>URL Query as State</h1>
    <section>
      <h2>Visible</h2>
      <p>State: {{ isVisible }}</p>
      <button @click="changeVisible">Change</button>
    </section>
  </div>
</template>

<script lang="ts" setup>
const router = useRouter()
const route = useRoute()

const isVisible = ref(route.query.visible ? route.query.visible : 'false')

watch(isVisible, (current, previous) => {
  router.push({
    path: route.path,
    query: { visible: current },
    replace: true
  })
})

function changeVisible() {
  isVisible.value = isVisible.value == 'true' ? 'false' : 'true'
}
</script>
```

## Membuat Composable

Berdasarkan contoh, dapat dibuat menjadi composable, sehingga menjadi seperti ini:

```ts /composables/urlState.ts
export const useUrlstate = (key: string, defaultValue: string = '', isReplace: boolean = true) => {
  const router = useRouter()
  const route = useRoute()

  const currentValue = route.query[key]?.toString()

  const state = ref<string>(currentValue ?? defaultValue)

  watch(state, (current, previous) => {
    const currentQuery = { ...route.query }
    currentQuery[key] = current

    router.push({
      path: route.path,
      query: currentQuery,
      replace: isReplace
    })
  })

  return state
}
```

```vue
<template>
  <div>
    <h1>URL Query as State</h1>
    <section>
      <h2>Visible</h2>
      <p>State: {{ visibleState }}</p>
      <button @click="changeVisible">Change</button>
    </section>
    <section>
      <h2>Filter</h2>
      <p>State: {{ filterState }}</p>
      <button @click="changeFilter">Change</button>
    </section>
  </div>
</template>

<script lang="ts" setup>
const visibleState = useUrlstate('visible', '')
const filterState = useUrlstate('filter', 'name')

function changeVisible() {
  visibleState.value = visibleState.value == 'true' ? 'false' : 'true'
}

function changeFilter() {
  filterState.value = filterState.value == 'name' ? 'email' : 'name'
}
</script>
```

## Referensi

1. https://codybontecou.com/using-url-query-params-in-nuxt-3.html
